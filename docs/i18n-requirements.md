# 多言語対応要件定義書

## ドキュメント情報

| 項目 | 内容 |
|------|------|
| ドキュメント名 | PC Parts Shop 多言語対応要件定義書 |
| バージョン | 1.0 |
| 作成日 | 2026-02-03 |
| 最終更新日 | 2026-02-03 |
| ステータス | 承認待ち |

---

## 1. 概要

### 1.1 目的

本ドキュメントは、PC Parts Shop（パソコン用品ECサイト）における多言語対応の要件を明確化し、開発・運用における指針を提供することを目的とする。

### 1.2 スコープ

本要件定義は以下の範囲を対象とする：
- フロントエンド（React SPA）の多言語対応
- バックエンド（Express.js API）のデータ多言語化
- 翻訳管理プロセス
- 品質保証プロセス

### 1.3 前提条件

- i18next および react-i18next を使用した国際化フレームワークを採用
- クライアントサイドでの言語切り替え（ページリロード不要）
- LocalStorage を使用した言語設定の永続化

---

## 2. 対応言語仕様

### 2.1 サポート対象言語

| 優先度 | 言語コード | 言語名 | ロケール | 実装状況 |
|--------|-----------|--------|----------|----------|
| P0（必須） | ja | 日本語 | ja-JP | ✅ 実装済み |
| P0（必須） | en | 英語 | en-US | ✅ 実装済み |
| P1（推奨） | zh-Hans | 簡体字中国語 | zh-CN | ⬜ 未実装 |
| P2（将来検討） | ko | 韓国語 | ko-KR | ⬜ 未実装 |
| P2（将来検討） | de | ドイツ語 | de-DE | ⬜ 未実装 |
| P2（将来検討） | fr | フランス語 | fr-FR | ⬜ 未実装 |

### 2.2 デフォルト言語

- **デフォルト言語**: 日本語（ja）
- **フォールバック言語**: 日本語（ja）
- **理由**: 主要ターゲット市場が日本であるため

### 2.3 言語判定ロジック

言語は以下の優先順位で決定される：

1. **ユーザーが選択した言語**（LocalStorageに保存）
2. **ブラウザの言語設定**（navigator.language）
3. **デフォルト言語**（ja）

```javascript
// 実装済み: src/i18n/index.js
detection: {
  order: ['localStorage', 'navigator'],
  caches: ['localStorage'],
}
```

---

## 3. 翻訳対象範囲

### 3.1 UI要素の翻訳対象

#### 3.1.1 必須翻訳項目（すべての言語で翻訳必須）

| カテゴリ | 項目例 | 実装状況 |
|---------|--------|----------|
| ナビゲーション | ホーム、商品一覧、カート、注文履歴 | ✅ 実装済み |
| ボタン | カートに追加、購入手続きへ、注文を確定する | ✅ 実装済み |
| ラベル | 価格、在庫、数量、カテゴリ | ✅ 実装済み |
| フォーム | メールアドレス、パスワード、郵便番号 | ✅ 実装済み |
| メッセージ | カートに追加しました、注文が完了しました | ✅ 実装済み |
| エラーメッセージ | ログインに失敗しました、在庫が不足しています | ✅ 実装済み |
| ローディング表示 | 読み込み中...、商品を読み込んでいます... | ✅ 実装済み |

#### 3.1.2 商品データの翻訳対象

| データ種別 | 翻訳対応 | 実装状況 | 備考 |
|-----------|---------|----------|------|
| 商品名 | ⚠️ 必要 | ⬜ 未実装 | 現在は日本語のみ |
| 商品説明 | ⚠️ 必要 | ⬜ 未実装 | 現在は日本語のみ |
| カテゴリ名 | ⚠️ 必要 | ⬜ 未実装 | 現在は日本語のみ |
| カテゴリ説明 | ⚠️ 必要 | ⬜ 未実装 | 現在は日本語のみ |
| 仕様項目名 | ⚠️ 必要 | ⬜ 未実装 | 例：「コア数」→「Core Count」 |
| ブランド名 | ✅ 不要 | - | 固有名詞のため翻訳不要 |
| 型番 | ✅ 不要 | - | 技術仕様のため翻訳不要 |

### 3.2 翻訳対象外

以下の項目は翻訳対象外とする：

| 項目 | 理由 |
|------|------|
| ユーザー入力データ | ユーザーが入力した住所、名前等は翻訳しない |
| 注文履歴データ | 注文時点の言語で表示（翻訳しない） |
| ブランド名 | 固有名詞のため（例：Intel, AMD, NVIDIA） |
| 型番・仕様値 | 技術的な固有値のため（例：RTX 4090, DDR5-6400） |
| 価格 | 数値は言語に依存しない（フォーマットのみ調整） |

---

## 4. 画面別多言語対応仕様

### 4.1 ログイン画面（SCR-001）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| ページタイトル | ✅ 必要 | ✅ 実装済み |
| ログインボタン | ✅ 必要 | ✅ 実装済み |
| フォームラベル（メール、パスワード） | ✅ 必要 | ✅ 実装済み |
| プレースホルダーテキスト | ✅ 必要 | ✅ 実装済み |
| エラーメッセージ | ✅ 必要 | ✅ 実装済み |
| デモアカウント説明 | ✅ 必要 | ✅ 実装済み |

**言語切り替えUI**: ログイン画面にも言語切り替えボタンを表示

### 4.2 商品一覧画面（SCR-002）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| ページタイトル | ✅ 必要 | ✅ 実装済み |
| カテゴリフィルター | ⚠️ 必要 | ⬜ 未実装（カテゴリ名） |
| 検索プレースホルダー | ✅ 必要 | ✅ 実装済み |
| ソートオプション | ✅ 必要 | ✅ 実装済み |
| 商品名 | ⚠️ 必要 | ⬜ 未実装 |
| 在庫表示 | ✅ 必要 | ✅ 実装済み |
| カートに追加ボタン | ✅ 必要 | ✅ 実装済み |
| ページネーション | ✅ 必要 | ✅ 実装済み |
| 検索結果件数 | ✅ 必要 | ✅ 実装済み |

**特記事項**: 商品検索は言語に関わらず全商品を対象とする

### 4.3 商品詳細画面（SCR-003）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| 商品名 | ⚠️ 必要 | ⬜ 未実装 |
| 商品説明 | ⚠️ 必要 | ⬜ 未実装 |
| 仕様項目名 | ⚠️ 必要 | ⬜ 未実装 |
| 価格表示 | ✅ 必要 | ✅ 実装済み（フォーマット） |
| 在庫表示 | ✅ 必要 | ✅ 実装済み |
| レビュー件数 | ✅ 必要 | ✅ 実装済み |
| ボタン（カートに追加、一覧に戻る） | ✅ 必要 | ✅ 実装済み |
| 数量ラベル | ✅ 必要 | ✅ 実装済み |

**特記事項**: 仕様項目（specifications）のキー名も翻訳が必要

### 4.4 カート画面（SCR-004）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| ページタイトル | ✅ 必要 | ✅ 実装済み |
| 商品名 | ⚠️ 必要 | ⬜ 未実装 |
| 小計・合計ラベル | ✅ 必要 | ✅ 実装済み |
| ボタン（削除、購入手続きへ） | ✅ 必要 | ✅ 実装済み |
| 空カートメッセージ | ✅ 必要 | ✅ 実装済み |
| 確認ダイアログ | ✅ 必要 | ✅ 実装済み |

### 4.5 注文確認画面（SCR-005）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| ページタイトル | ✅ 必要 | ✅ 実装済み |
| 配送先情報ラベル | ✅ 必要 | ✅ 実装済み |
| フォームラベル | ✅ 必要 | ✅ 実装済み |
| 注文サマリー | ✅ 必要 | ✅ 実装済み |
| 商品名 | ⚠️ 必要 | ⬜ 未実装 |
| ボタン | ✅ 必要 | ✅ 実装済み |

**特記事項**: 住所入力フォームは日本形式のみサポート

### 4.6 注文完了画面（SCR-006）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| 完了メッセージ | ✅ 必要 | ✅ 実装済み |
| 注文情報ラベル | ✅ 必要 | ✅ 実装済み |
| ステータス表示 | ✅ 必要 | ✅ 実装済み |
| ボタン | ✅ 必要 | ✅ 実装済み |

### 4.7 注文履歴画面（SCR-007）

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| ページタイトル | ✅ 必要 | ✅ 実装済み |
| 注文情報ラベル | ✅ 必要 | ✅ 実装済み |
| 商品名 | ⚠️ 必要 | ⬜ 未実装 |
| ステータス表示 | ✅ 必要 | ✅ 実装済み |
| 空メッセージ | ✅ 必要 | ✅ 実装済み |

**特記事項**: 注文履歴の商品名は注文時点の言語で表示（翻訳しない）

### 4.8 共通要素

| 要素 | 翻訳対応 | 実装状況 |
|------|---------|----------|
| ヘッダーナビゲーション | ✅ 必要 | ✅ 実装済み |
| フッター | ✅ 必要 | ⬜ 未実装（存在しない場合） |
| 言語切り替えボタン | ✅ 必要 | ✅ 実装済み |
| ローディング表示 | ✅ 必要 | ✅ 実装済み |
| ユーザー名表示 | ⚠️ 要検討 | ✅ 実装済み（名前順序が言語依存） |

---

## 5. 技術仕様

### 5.1 フロントエンド実装

#### 5.1.1 使用ライブラリ

```json
{
  "i18next": "^25.8.0",
  "i18next-browser-languagedetector": "^8.2.0",
  "react-i18next": "^16.5.4"
}
```

#### 5.1.2 翻訳ファイル構造

```
src/
  locales/
    ja/
      translation.json    # 日本語翻訳
    en/
      translation.json    # 英語翻訳
    zh-Hans/              # 将来追加予定
      translation.json
```

#### 5.1.3 翻訳キー命名規則

- 階層構造を使用（ドット記法）
- キー名は英語で記述
- 画面単位または機能単位でグループ化

```javascript
// 良い例
"productDetail.addToCart": "カートに追加"
"cart.empty.message": "カートは空です"

// 悪い例
"button1": "カートに追加"
"msg": "カートは空です"
```

#### 5.1.4 複数形対応

- 英語: `_one`, `_other` サフィックスを使用
- 日本語: 単一形式のみ

```json
// 英語
{
  "items_one": "{{count}} item",
  "items_other": "{{count}} items"
}

// 日本語
{
  "items": "{{count}}点"
}
```

### 5.2 バックエンド実装

#### 5.2.1 商品データ多言語化

現在の商品データは日本語のみのため、以下の構造に変更が必要：

**現在の構造:**
```json
{
  "id": "prod-001",
  "name": "Intellon Core X9-14900K",
  "description": "第14世代Intellon Coreプロセッサー...",
  "specifications": {
    "コア数": "24 (8P+16E)"
  }
}
```

**提案する構造:**
```json
{
  "id": "prod-001",
  "name": {
    "ja": "Intellon Core X9-14900K",
    "en": "Intellon Core X9-14900K"
  },
  "description": {
    "ja": "第14世代Intellon Coreプロセッサー。24コア/32スレッドの最高峰CPU。",
    "en": "14th generation Intellon Core processor. Flagship CPU with 24 cores and 32 threads."
  },
  "specifications": {
    "ja": {
      "コア数": "24 (8P+16E)",
      "スレッド数": "32",
      "ベースクロック": "3.2GHz"
    },
    "en": {
      "Core Count": "24 (8P+16E)",
      "Thread Count": "32",
      "Base Clock": "3.2GHz"
    }
  }
}
```

#### 5.2.2 APIレスポンス対応

オプション1: クライアントが言語コードを送信し、サーバーが該当言語のデータを返す
```javascript
GET /api/products?lang=en
```

オプション2: すべての言語データを返し、クライアント側で選択
```javascript
GET /api/products
// レスポンスに全言語のデータを含む
```

**推奨**: オプション1（データ転送量削減のため）

#### 5.2.3 カテゴリデータ多言語化

```json
[
  {
    "id": "cat-001",
    "name": {
      "ja": "CPU",
      "en": "CPU"
    },
    "description": {
      "ja": "プロセッサー",
      "en": "Processor"
    }
  }
]
```

### 5.3 日付・数値・通貨フォーマット

| フォーマット種別 | 日本語 | 英語 |
|----------------|--------|------|
| 日付 | 2026年2月3日 | February 3, 2026 |
| 時刻 | 10:51 | 10:51 AM |
| 数値（千の位） | 89,800 | 89,800 |
| 通貨 | ¥89,800 | ¥89,800 |

**実装方法**: Intl API を使用

```javascript
// 日付
new Intl.DateTimeFormat(locale).format(date)

// 通貨
new Intl.NumberFormat(locale, { 
  style: 'currency', 
  currency: 'JPY' 
}).format(price)
```

---

## 6. 品質要件

### 6.1 翻訳品質基準

| 基準 | 説明 |
|------|------|
| 正確性 | 原文の意味を正確に伝える |
| 一貫性 | 用語の使用が統一されている |
| 自然さ | ネイティブスピーカーにとって自然な表現 |
| 簡潔性 | 不要に長い表現を避ける |
| 文化的適切性 | 文化的に不適切な表現を避ける |

### 6.2 翻訳カバレッジ

- **必須**: P0言語（ja, en）は100%の翻訳カバレッジ
- **推奨**: P1言語（zh-Hans）は95%以上の翻訳カバレッジ
- **最低限**: P2言語は80%以上の翻訳カバレッジ

### 6.3 テスト要件

#### 6.3.1 機能テスト

- [ ] 各画面で言語切り替えが正常に動作する
- [ ] 言語設定がLocalStorageに保存される
- [ ] ページリロード後も選択言語が保持される
- [ ] フォールバック動作が正常に機能する
- [ ] すべてのUI要素が翻訳されている

#### 6.3.2 表示テスト

- [ ] 各言語でテキストが正常に表示される
- [ ] テキストのオーバーフロー、切り詰めが発生しない
- [ ] 長い文字列でもレイアウトが崩れない
- [ ] 文字化けが発生しない

#### 6.3.3 ユーザビリティテスト

- [ ] ネイティブスピーカーによる翻訳品質確認
- [ ] 文化的に不適切な表現がないことの確認
- [ ] 専門用語が適切に翻訳されていることの確認

### 6.4 性能要件

| 項目 | 要件 |
|------|------|
| 言語切り替え時間 | 0.5秒以内（ページリロードなし） |
| 初回読み込み時間 | 追加のオーバーヘッドは0.5秒以内 |
| 翻訳ファイルサイズ | 言語あたり100KB以下 |

---

## 7. 運用・保守要件

### 7.1 翻訳管理フロー

```
1. 開発者が新機能を実装
   ↓
2. 日本語翻訳キーを追加
   ↓
3. 他言語の翻訳が必要な旨をIssueに記載
   ↓
4. 翻訳担当者が翻訳を追加
   ↓
5. レビュー・承認
   ↓
6. マージ・デプロイ
```

### 7.2 翻訳の更新・追加プロセス

#### 新規翻訳追加時

1. `src/locales/ja/translation.json` に日本語キーを追加
2. 対応する英語翻訳を `src/locales/en/translation.json` に追加
3. 必要に応じて他言語の翻訳も追加
4. プルリクエストを作成し、翻訳レビューを依頼

#### 既存翻訳修正時

1. 該当する翻訳ファイルを修正
2. すべての言語で一貫性を確認
3. プルリクエストを作成し、レビューを依頼

### 7.3 翻訳の一貫性管理

#### 用語集の管理

重要な用語は用語集で管理する：

| 日本語 | 英語 | 備考 |
|--------|------|------|
| カート | Cart | 「Shopping Cart」は長いため避ける |
| 商品 | Product | 「Item」は使用しない |
| 注文 | Order | |
| 在庫 | Stock | 「Inventory」ではなく「Stock」 |
| 購入手続き | Checkout | |

### 7.4 バージョン管理

- 翻訳ファイルはGitで管理
- 重要な変更には変更履歴をコミットメッセージに記載
- 大規模な翻訳更新は専用ブランチで作業

### 7.5 モニタリング

#### 翻訳の使用状況

- 翻訳漏れの検出（開発環境でのみ警告表示）
- 未使用の翻訳キーの検出

#### ユーザー分析

- 各言語の使用率を分析
- 言語切り替えの頻度を測定
- 言語別のユーザー行動分析

---

## 8. 将来の拡張計画

### 8.1 追加予定言語

#### フェーズ2（3-6ヶ月後）

- 簡体字中国語（zh-Hans）
- 理由: アジア市場への展開

#### フェーズ3（6-12ヶ月後）

- 韓国語（ko）
- ドイツ語（de）
- フランス語（fr）

### 8.2 機能拡張

#### 地域固有機能

- 通貨の切り替え対応（現在はJPYのみ）
- 配送先住所フォーマットの多様化
- 地域別の税率対応

#### 高度な翻訳機能

- コンテキスト依存の翻訳
- 動的コンテンツの自動翻訳（AIによる）
- ユーザー生成コンテンツの翻訳サポート

### 8.3 管理ツール

- 翻訳管理ダッシュボードの開発
- 翻訳進捗の可視化
- 翻訳品質チェックの自動化

---

## 9. リスクと対応策

### 9.1 主要リスク

| リスク | 影響度 | 発生確率 | 対応策 |
|--------|--------|----------|--------|
| 翻訳品質の低下 | 高 | 中 | ネイティブレビュー、用語集の整備 |
| 翻訳漏れ | 中 | 高 | 自動チェックツールの導入 |
| 表示崩れ | 中 | 中 | 各言語での表示テスト |
| パフォーマンス低下 | 低 | 低 | 翻訳ファイルサイズの監視 |
| 保守コストの増加 | 中 | 高 | 効率的な翻訳管理フロー |

### 9.2 課題と対応

#### 課題1: 商品データの多言語化が未実装

**対応**: 
- 短期: UIテキストの多言語化を優先
- 中期: 商品データ構造の変更を計画
- 長期: CMS導入を検討

#### 課題2: 専門用語の翻訳

**対応**:
- PC部品の専門用語は業界標準の翻訳を使用
- 不明な場合は英語表記を採用
- 用語集を整備し一貫性を確保

#### 課題3: メンテナンスコスト

**対応**:
- 翻訳キーの命名規則を統一
- 翻訳ファイルの構造を最適化
- 自動化ツールの導入検討

---

## 10. 承認

### 10.1 承認プロセス

本要件定義は以下の承認を経て確定する：

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| プロダクトオーナー | | | |
| 技術リード | | | |
| UI/UXデザイナー | | | |
| 翻訳責任者 | | | |

### 10.2 レビューコメント

承認プロセス中に受け取ったフィードバック：

- （承認者からのコメントをここに記載）

---

## 11. 付録

### 11.1 参考資料

- [i18next Documentation](https://www.i18next.com/)
- [React-i18next Documentation](https://react.i18next.com/)
- [W3C Internationalization Best Practices](https://www.w3.org/International/)
- [Mozilla L10n Style Guide](https://mozilla-l10n.github.io/styleguides/)

### 11.2 用語定義

| 用語 | 定義 |
|------|------|
| i18n | Internationalization（国際化）の略。18は「i」と「n」の間の文字数 |
| L10n | Localization（地域化）の略。特定の地域や言語への適応 |
| ロケール | 言語と地域の組み合わせ（例: ja-JP, en-US） |
| フォールバック | 翻訳が存在しない場合に代替表示する仕組み |
| 名前空間 | 翻訳キーをグループ化して管理する単位 |
| RTL | Right-to-Left。右から左に書く言語（アラビア語等） |

### 11.3 変更履歴

| バージョン | 日付 | 変更内容 | 変更者 |
|-----------|------|----------|--------|
| 1.0 | 2026-02-03 | 初版作成 | GitHub Copilot |

---

**本ドキュメントに関する質問・フィードバックは、プロジェクトのIssueまたはPull Requestにてお願いします。**
